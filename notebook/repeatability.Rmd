---
title: "Repeatablity in female mate choice"
output: html_notebook
editor_options: 
  chunk_output_type: console
---

This is a notebook for testing within (and among) individual repeatability in 
female mate choice.
Visualisation is essential in this task. specifically I have plotted
1. individual variation
2. male rank
3. male life history
4. male suitability


```{r load packages}
library(hyenaR)
load_package_database.full(db.path = "data/Fisidata_20122021.sqlite")
library(tidyverse)
library(lubridate)
library(pheatmap)
library(raincloudplots)
library(cowplot)
library(EnvStats)
```

```{r load and preprocessing data}
load("data/Zimai_ms_raw.Rdata")

# create experience sequence
conceptions_full %>% 
  mutate(female_sequence = factor(as.numeric(str_extract(conID, "\\d+$"))),
         male.age.cat = factor(case_when(
                                  male.age <= 5 ~ "Young",
                                  male.age > 5 ~ "Old",
                                  TRUE ~ NA_character_
                                  ), levels = c("Young", "Old"))) %>% 
  group_by(femaleID) %>% 
  mutate(female_choices = n()) %>% 
  ungroup() -> conceptions_female

# create male uniqueness
conceptions_female %>% 
# drop_na(maleID) %>% 
  group_by(femaleID) %>% 
  mutate(maleUnique = factor(ifelse(is.na(maleID), NA_character_, row_number()), levels = c("1","2","3","4","5", "6", "7", "8", "9","10", "11", "12", NA_character_))) %>% 
  select(femaleID, maleID, maleUnique) %>% 
  group_by(femaleID, maleID) %>% 
  slice(1) -> maleUnique

left_join(conceptions_female, maleUnique) -> conceptions_female_withmaleUnique
```

```{r plotting male uniqueness for each female}
ggplot(conceptions_female_withmaleUnique, aes(x = female_sequence, y = reorder(femaleID, female_choices), color = maleUnique)) +
  geom_point() +
  scale_color_discrete()
ggsave("plots/sequentialIDfemaleChoice.pdf", width = 10, height = 120, units = "cm")

ggplot(conceptions_female_withmaleUnique, aes(x = female_sequence, y = reorder(femaleID, female_choices), color = male.rank.cat)) +
  geom_point() +
  scale_color_discrete()
ggsave("plots/sequentialMaleRankfemaleChoice.pdf", width = 10, height = 120, units = "cm")

ggplot(conceptions_female_withmaleUnique, aes(x = female_sequence, y = reorder(femaleID, female_choices), color = male.lifstg)) +
  geom_point() +
  scale_color_discrete()
ggsave("plots/sequentialMaleLifeStagefemaleChoice.pdf", width = 10, height = 120, units = "cm")

ggplot(conceptions_female_withmaleUnique, aes(x = female_sequence, y = reorder(femaleID, female_choices), color = male.age.cat)) +
  geom_point() +
  scale_color_discrete()
ggsave("plots/sequentialMaleAgefemaleChoice.pdf", width = 10, height = 120, units = "cm")
```

Create male table
```{r}
conceptions_full %>% 
  drop_na(maleID) %>% 
  group_by(maleID) %>% 
  arrange(date, .by_group = TRUE) %>% 
  mutate(male_sequence = row_number(),
         male_choices = n()) %>% 
  ungroup() %>% 
  mutate(fem.age.cat = factor(case_when(fem.age <= 5 ~ "Young",
                           fem.age > 5 ~ "Old",
                           TRUE ~ NA_character_), levels = c("Young", "Old"))) -> conceptions_male

# create female uniqueness
conceptions_male %>% 
# drop_na(maleID) %>% 
  group_by(maleID) %>% 
  mutate(femaleUnique = factor(ifelse(is.na(femaleID), NA_character_, row_number()))) %>% 
  select(maleID, femaleID, femaleUnique) %>% 
  group_by(maleID, femaleID) %>% 
  slice(1) -> femaleUnique

left_join(conceptions_male, femaleUnique) -> conceptions_male_withfemaleUnique

```

```{r}
ggplot(conceptions_male_withfemaleUnique, aes(x = male_sequence, y = reorder(maleID, male_choices), color = femaleUnique)) +
  geom_point() +
  scale_color_discrete()

ggsave("../plots/sequentialIDmaleChoice.pdf", width = 10, height = 120, units = "cm")

ggplot(conceptions_male_withfemaleUnique, aes(x = male_sequence, y = reorder(maleID, male_choices), color = fem.rank.cat)) +
  geom_point() +
  scale_color_discrete()

ggsave("../plots/sequentialfemaleRankmaleChoice.pdf", width = 10, height = 120, units = "cm")

ggplot(conceptions_male_withfemaleUnique, aes(x = male_sequence, y = reorder(maleID, male_choices), color = fem.age.cat)) +
  geom_point() +
  scale_color_discrete()

ggsave("../plots/sequentialfemaleAgemaleChoice.pdf", width = 10, height = 120, units = "cm")
```


plot distributions
```{r}
left_join(conceptions_female_withmaleUnique, conceptions_male_withfemaleUnique) %>% 
  mutate(fem.parity = fetch_id_parity(femaleID, date),
        fem.parity.cat = factor(case_when(
          fem.parity == 1 ~ "Primiparious",
          fem.parity > 1 & fem.parity < 4 ~ "Pluriparious < 4",
          fem.parity > 4 ~ "Pluriparious > 4", 
          TRUE ~ NA_character_), levels = c("Primiparious", "Pluriparious < 4", "Pluriparious > 4")),
        male.parity = fetch_id_parity(maleID, date),
        male.parity.cat = factor(case_when(
          male.parity == 1 ~ "Primiparious",
          male.parity > 1 & male.parity < 4 ~ "Pluriparious < 4",
          male.parity > 4 ~ "Pluriparious > 4", 
          TRUE ~ NA_character_), levels = c("Primiparious", "Pluriparious < 4", "Pluriparious > 4")),
        )-> conceptions




conceptions %>% 
  select(femaleID, female_choices) %>% 
  unique() %>% 
  mutate(sex = "female") %>% 
  rename(ID = femaleID, choice = female_choices) -> femaleChoices

conceptions %>% 
  select(maleID, male_choices) %>% 
  unique() %>% 
  drop_na() %>% 
  mutate(sex = "male") %>% 
  rename(ID = maleID, choice = male_choices) -> maleChoices

thresholdrank <- c(1/3, 2/3)
bind_rows(femaleChoices, maleChoices) %>% 
  mutate(censored = fetch_id_is.censored(ID),
         birthRank = fetch_id_rank.birth.std(ID),
         birthRankCat = recode_rank.std_rank.cat(birthRank, thresholdrank),
         birthRankCatRecode = factor(case_when(
           birthRankCat == "0--33%" ~ "High",
           birthRankCat == "33--67%" ~ "Medium",
           birthRankCat == "67--100%" ~ "Low",
           TRUE ~ NA_character_
         ), levels = c("Low", "Medium", "High"))) -> Choices

source("R/R_rainclouds.R")
Choices %>% 
  filter(!censored) %>% 
  drop_na(birthRank) %>%   
  ggplot(.,aes(x=birthRankCatRecode,y=choice, fill = birthRankCatRecode, colour = birthRankCatRecode))+
  geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust = 1.5, trim = FALSE)+
  geom_point(position = position_jitter(width = .15), size = .25)+
  geom_boxplot(aes(x = birthRankCatRecode, y = choice), position = position_nudge(x = .2, y = 0), outlier.shape = NA, alpha = 0.3, width = .05, colour = "black") +
  ylab('Number of successful matings')+xlab('Birth Rank')+
  ylim(0, 21)+
  coord_flip()+
  theme_cowplot()+
  guides(fill = "none", colour = "none") +
  scale_colour_brewer(palette = "Dark2")+
  scale_fill_brewer(palette = "Dark2") +
  stat_n_text(position = position_nudge(x = 0.5, y = 20)) +
  ggtitle("Number of choices amongst non-censored \nindividuals that successfully mated")+
  facet_wrap(~ sex)
ggsave("plots/raincloudChoicesSuccessInd.pdf", units = "cm", width = 20, height = 14)

create_id_starting.table(ID = find_pop_id.female.all()) %>% 
  mutate(censored = fetch_id_is.censored(ID),
         birthRank = fetch_id_rank.birth.std(ID),
         birthRankCat = recode_rank.std_rank.cat(birthRank, thresholdrank),
         birthRankCatRecode = factor(case_when(
           birthRankCat == "0--33%" ~ "High",
           birthRankCat == "33--67%" ~ "Medium",
           birthRankCat == "67--100%" ~ "Low",
           TRUE ~ NA_character_
         ), levels = c("Low", "Medium", "High")),
         numberSuccessfulLitter = fetch_id_number.litter(ID)) %>% 
  filter(!censored & !is.na(birthRankCat)) -> femaleChoiceAll

ggplot(femaleChoiceAll,aes(x=birthRankCatRecode, y=numberSuccessfulLitter, fill = birthRankCatRecode, colour = birthRankCatRecode))+
  geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust = 1.5, trim = FALSE)+
  geom_point(position = position_jitter(width = .15), size = .25)+
  geom_boxplot(aes(x = birthRankCatRecode, y = numberSuccessfulLitter), position = position_nudge(x = .2, y = 0), outlier.shape = NA, alpha = 0.3, width = .05, colour = "black") +
  ylab('Number of successful matings')+xlab('Birth Rank')+
  ylim(0, 21)+
  coord_flip()+
  theme_cowplot()+
  guides(fill = "none", colour = "none") +
  scale_colour_brewer(palette = "Dark2")+
  scale_fill_brewer(palette = "Dark2") +
  stat_n_text(position = position_nudge(x = 0.5, y = 20)) +
  ggtitle("Number of choices amongst all \nnon-censored females")
ggsave("plots/raincloudChoicesFemales.pdf", units = "cm", width = 12, height = 14)
# once female start to reproduce, birth rank does not decide number of choices to make (conception times), suggesting high and low rank females get similar number of mating numbers

conceptions %>% 
  drop_na(fem.rank.cat, male.rank) %>% 
  ggplot(.,aes(x=fem.rank.cat, y=male.rank, fill = fem.rank.cat, colour = fem.rank.cat))+
  geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust = 1.5, trim = FALSE)+
  geom_point(position = position_jitter(width = .15), size = .25)+
  geom_boxplot(aes(x = fem.rank.cat, y = male.rank), position = position_nudge(x = .2, y = 0), outlier.shape = NA, alpha = 0.3, width = .05, colour = "black") +
  ylab('Male Rank')+xlab('Female Rank Category')+
  ylim(-1, 1)+
  coord_flip()+
  theme_cowplot()+
  guides(fill = "none", colour = "none") +
  scale_colour_brewer(palette = "Dark2")+
  scale_fill_brewer(palette = "Dark2") +
  stat_n_text(position = position_nudge(x = 0.5, y = 2)) +
  ggtitle("Male rank in all the matings")
ggsave("plots/raincloudMaleRankFemaleRank.pdf", units = "cm", width = 12, height = 14)

conceptions %>% 
  drop_na(fem.age.cat, male.rank) %>% 
  ggplot(.,aes(x=fem.age.cat, y=male.rank, fill = fem.age.cat, colour = fem.age.cat))+
  geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust = 1.5, trim = FALSE)+
  geom_point(position = position_jitter(width = .15), size = .25)+
  geom_boxplot(aes(x = fem.age.cat, y = male.rank), position = position_nudge(x = .2, y = 0), outlier.shape = NA, alpha = 0.3, width = .05, colour = "black") +
  ylab('Male Rank')+xlab('Female age Category')+
  ylim(-1, 1)+
  coord_flip()+
  theme_cowplot()+
  guides(fill = "none", colour = "none") +
  scale_colour_brewer(palette = "Paired")+
  scale_fill_brewer(palette = "Paired") +
  stat_n_text(position = position_nudge(x = 0.5, y = 2)) +
  ggtitle("Male rank in all the matings")
ggsave("plots/raincloudMaleRankFemaleAge.pdf", units = "cm", width = 12, height = 14)
# young females tend to mate with more low rank males than old females 

conceptions %>% 
  drop_na(fem.parity.cat, male.rank) %>% 
  ggplot(.,aes(x=fem.parity.cat, y=male.rank, fill = fem.parity.cat, colour = fem.parity.cat))+
  geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust = 1.5, trim = FALSE)+
  geom_point(position = position_jitter(width = .15), size = .25)+
  geom_boxplot(aes(x = fem.parity.cat, y = male.rank), position = position_nudge(x = .2, y = 0), outlier.shape = NA, alpha = 0.3, width = .05, colour = "black") +
  ylab('Male Rank')+xlab('Female Parity Category')+
  ylim(-1, 1)+
  coord_flip()+
  theme_cowplot()+
  guides(fill = "none", colour = "none") +
  scale_colour_brewer(palette = "Accent")+
  scale_fill_brewer(palette = "Accent") +
  stat_n_text(position = position_nudge(x = 0.5, y = 2)) +
  ggtitle("Male rank in all the matings")
ggsave("plots/raincloudMaleRankFemaleParity.pdf", units = "cm", width = 12, height = 14)
  

conceptions %>% 
  drop_na(fem.rank.cat, male.age) %>% 
  ggplot(.,aes(x=fem.rank.cat, y=male.age, fill = fem.rank.cat, colour = fem.rank.cat))+
  geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust = 1.5, trim = FALSE)+
  geom_point(position = position_jitter(width = .15), size = .25)+
  geom_boxplot(aes(x = fem.rank.cat, y = male.age), position = position_nudge(x = .2, y = 0), outlier.shape = NA, alpha = 0.3, width = .05, colour = "black") +
  ylab('Male Age')+xlab('Female Rank Category')+
  ylim(0, 20)+
  coord_flip()+
  theme_cowplot()+
  guides(fill = "none", colour = "none") +
  scale_colour_brewer(palette = "Dark2")+
  scale_fill_brewer(palette = "Dark2") +
  stat_n_text(position = position_nudge(x = 0.5, y = 2)) +
  ggtitle("Male age in all the matings")
ggsave("plots/raincloudMaleAgeFemaleRank.pdf", units = "cm", width = 12, height = 14)
  

conceptions %>% 
  drop_na(fem.age.cat, male.age) %>% 
  ggplot(.,aes(x=fem.age.cat, y=male.age, fill = fem.age.cat, colour = fem.age.cat))+
  geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust = 1.5, trim = FALSE)+
  geom_point(position = position_jitter(width = .15), size = .25)+
  geom_boxplot(aes(x = fem.age.cat, y = male.age), position = position_nudge(x = .2, y = 0), outlier.shape = NA, alpha = 0.3, width = .05, colour = "black") +
  ylab('Male Age')+xlab('Female Age Category')+
  ylim(0, 20)+
  coord_flip()+
  theme_cowplot()+
  guides(fill = "none", colour = "none") +
  scale_colour_brewer(palette = "Paired")+
  scale_fill_brewer(palette = "Paired") +
  stat_n_text(position = position_nudge(x = 0.5, y = 2)) +
  ggtitle("Male age in all the matings")
ggsave("plots/raincloudMaleAgeFemaleAge.pdf", units = "cm", width = 12, height = 14)
# young females tend to mate with more young males than old females

conceptions %>% 
  drop_na(fem.parity.cat, male.age) %>% 
  ggplot(.,aes(x=fem.parity.cat, y=male.age, fill = fem.parity.cat, colour = fem.parity.cat))+
  geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust = 1.5, trim = FALSE)+
  geom_point(position = position_jitter(width = .15), size = .25)+
  geom_boxplot(aes(x = fem.parity.cat, y = male.age), position = position_nudge(x = .2, y = 0), outlier.shape = NA, alpha = 0.3, width = .05, colour = "black") +
  ylab('Male Age')+xlab('Female Parity Category')+
  ylim(0, 20)+
  coord_flip()+
  theme_cowplot()+
  guides(fill = "none", colour = "none") +
  scale_colour_brewer(palette = "Accent")+
  scale_fill_brewer(palette = "Accent") +
  stat_n_text(position = position_nudge(x = 0.5, y = 2)) +
  ggtitle("Male age in all the matings")
ggsave("plots/raincloudMaleAgeFemaleParity.pdf", units = "cm", width = 12, height = 14)
# primiparous females tend to mate with (much) more young males than pluriparous


conceptions %>% 
  drop_na(fem.rank.cat, male.parity) %>% 
  ggplot(.,aes(x=fem.rank.cat, y=male.parity, fill = fem.rank.cat, colour = fem.rank.cat))+
  geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust = 1.5, trim = FALSE)+
  geom_point(position = position_jitter(width = .15), size = .25)+
  geom_boxplot(aes(x = fem.rank.cat, y = male.age), position = position_nudge(x = .2, y = 0), outlier.shape = NA, alpha = 0.3, width = .05, colour = "black") +
  ylab('Male Parity')+xlab('Female Rank Category')+
  ylim(0, 22)+
  coord_flip()+
  theme_cowplot()+
  guides(fill = "none", colour = "none") +
  scale_colour_brewer(palette = "Dark2")+
  scale_fill_brewer(palette = "Dark2") +
  stat_n_text(position = position_nudge(x = 0.5, y = 20)) +
  ggtitle("Male Parity in all the matings")
ggsave("plots/raincloudMaleParityFemaleRank.pdf", units = "cm", width = 12, height = 14)
  

conceptions %>% 
  drop_na(fem.age.cat, male.parity) %>% 
  ggplot(.,aes(x=fem.age.cat, y=male.parity, fill = fem.age.cat, colour = fem.age.cat))+
  geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust = 1.5, trim = FALSE)+
  geom_point(position = position_jitter(width = .15), size = .25)+
  geom_boxplot(aes(x = fem.age.cat, y = male.age), position = position_nudge(x = .2, y = 0), outlier.shape = NA, alpha = 0.3, width = .05, colour = "black") +
  ylab('Male Parity')+xlab('Female Age Category')+
  ylim(0, 22)+
  coord_flip()+
  theme_cowplot()+
  guides(fill = "none", colour = "none") +
  scale_colour_brewer(palette = "Paired")+
  scale_fill_brewer(palette = "Paired") +
  stat_n_text(position = position_nudge(x = 0.5, y = 20)) +
  ggtitle("Male Parity in all the matings")
ggsave("plots/raincloudMaleParityFemaleAge.pdf", units = "cm", width = 12, height = 14)

conceptions %>% 
  drop_na(fem.parity.cat, male.parity) %>% 
  ggplot(.,aes(x=fem.parity.cat, y=male.parity, fill = fem.parity.cat, colour = fem.parity.cat))+
  geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust = 1.5, trim = FALSE)+
  geom_point(position = position_jitter(width = .15), size = .25)+
  geom_boxplot(aes(x = fem.parity.cat, y = male.age), position = position_nudge(x = .2, y = 0), outlier.shape = NA, alpha = 0.3, width = .05, colour = "black") +
  ylab('Male Parity')+xlab('Female Parity Category')+
  ylim(0, 22)+
  coord_flip()+
  theme_cowplot()+
  guides(fill = "none", colour = "none") +
  scale_colour_brewer(palette = "Accent")+
  scale_fill_brewer(palette = "Accent") +
  stat_n_text(position = position_nudge(x = 0.5, y = 20)) +
  ggtitle("Male Parity in all the matings")
ggsave("plots/raincloudMaleParityFemaleParity.pdf", units = "cm", width = 12, height = 14)
  
```
# we need a measurement that considers repeatability
1. calculate how many choices it will be if it is random choice in every step (bootstrap)
2. (# different mate when follows random choice / # mate during real choice) * # total choice to make 
```{r}
conceptions %>% 
  pivot_longer(., femaleID:maleID, names_to = "sex_ID", values_to = "ID") %>% 
  mutate(age = ifelse(sex_ID == "femaleID", fem.age, male.age),
         rank = ifelse(sex_ID == "femaleID", fem.rank, male.rank),
         parity = ifelse(sex_ID == "femaleID", fem.parity, male.parity)) -> conceptions_longer


df_1x1_age <- data_1x1(
  array_1 = conceptions_longer$age[conceptions_longer$sex_ID == "femaleID"],
  array_2 = conceptions_longer$age[conceptions_longer$sex_ID == "maleID"],
  jit_distance = .09,
  jit_seed = 321)

raincloud_age <- raincloud_1x1_repmes(
  data = df_1x1_age,
  colors = (c('darkorange', 'dodgerblue')),
  fills = (c('darkorange', 'dodgerblue')),
  line_color = 'gray',
  line_alpha = .1,
  size = 1,
  alpha = .6,
  align_clouds = FALSE) +
scale_x_continuous(breaks=c(1,2), labels=c("Female", "Male"), limits=c(0, 3)) +
  xlab("Sex") + 
  ylab("Age") +
  theme_classic() +
  ggtitle("female-male age in matings")
raincloud_age
ggsave("plots/pairwiseAge.pdf", units = "cm", width = 15, height = 15)

df_1x1_rank <- data_1x1(
  array_1 = conceptions_longer$rank[conceptions_longer$sex_ID == "femaleID"],
  array_2 = conceptions_longer$rank[conceptions_longer$sex_ID == "maleID"],
  jit_distance = .09,
  jit_seed = 321)

raincloud_rank <- raincloud_1x1_repmes(
  data = df_1x1_rank,
  colors = (c('darkorange', 'dodgerblue')),
  fills = (c('darkorange', 'dodgerblue')),
  line_color = 'gray',
  line_alpha = .1,
  size = 1,
  alpha = .6,
  align_clouds = FALSE) +
scale_x_continuous(breaks=c(1,2), labels=c("Female", "Male"), limits=c(0, 3)) +
  xlab("Sex") + 
  ylab("Rank") +
  theme_classic()+  
  ggtitle("female-male rank (within sex) in matings")

raincloud_rank
ggsave("plots/pairwiseRank.pdf", units = "cm", width = 15, height = 15)

df_1x1_parity <- data_1x1(
  array_1 = conceptions_longer$parity[conceptions_longer$sex_ID == "femaleID"],
  array_2 = conceptions_longer$parity[conceptions_longer$sex_ID == "maleID"],
  jit_distance = .09,
  jit_seed = 321)

raincloud_parity <- raincloud_1x1_repmes(
  data = df_1x1_parity,
  colors = (c('darkorange', 'dodgerblue')),
  fills = (c('darkorange', 'dodgerblue')),
  line_color = 'gray',
  line_alpha = .1,
  size = 1,
  alpha = .6,
  align_clouds = FALSE) +
scale_x_continuous(breaks=c(1,2), labels=c("Female", "Male"), limits=c(0, 3)) +
  xlab("Sex") + 
  ylab("Parity") +
  theme_classic()+
  ggtitle("female-male parity in matings")

raincloud_parity
ggsave("plots/pairwiseParity.pdf", units = "cm", width = 15, height = 15)
```

Relatedness
```{r}
# plot those inbreeding conceptions
conceptions %>% 
  mutate( relatedness = fetch_dyad_relatedness(femaleID, maleID)) -> conceptions_relatedness

conceptions_relatedness %>% 
  drop_na(relatedness, fem.rank) %>% 
  ggplot(., aes(x = fem.rank, y = relatedness, color = male.rank.cat)) +
  geom_point() +
  geom_rug(col=rgb(.5,0,0,alpha=.2))
# more high rank females (makes sense, they mate more conceives) more? and more with high rank males

conceptions_relatedness %>% 
  drop_na(relatedness, fem.rank) %>% 
  ggplot(., aes(x = fem.rank, y = relatedness, color = male.parity.cat)) +
  geom_point() +
  geom_rug(col=rgb(.5,0,0,alpha=.2))
# more with primiparious males # makes sense they are more likely to be philopatric

conceptions_relatedness %>% 
  drop_na(relatedness, fem.rank) %>% 
  ggplot(., aes(x = fem.rank, y = relatedness, color = male.lifstg)) +
  geom_point() +
  geom_rug(col=rgb(.5,0,0,alpha=.2))
# mostly philopatric males # makes sense those are more likely to be related

conceptions_relatedness %>% 
  drop_na(relatedness, fem.rank) %>% 
  ggplot(., aes(x = fem.rank, y = relatedness, color = male.age.cat)) +
  geom_point() +
  geom_rug(col=rgb(.5,0,0,alpha=.2))
# more young males # makes sense they are more likely to be philopatric

conceptions_relatedness %>% 
  drop_na(relatedness, fem.age) %>% 
  ggplot(., aes(x = fem.age, y = relatedness)) +
  geom_point() +
  geom_rug(col=rgb(.5,0,0,alpha=.2))
# female age seems not matter

conceptions_relatedness %>% 
  drop_na(relatedness, fem.parity) %>% 
  ggplot(., aes(x = fem.parity, y = relatedness)) +
  geom_jitter() +
  geom_rug(col=rgb(.5,0,0,alpha=.2))
# more primiparous females, also make sense (more primiparous matings)



```


